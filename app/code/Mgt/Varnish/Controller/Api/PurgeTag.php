<?php
 namespace Mgt\Varnish\Controller\Api; class PurgeTag extends \Magento\Framework\App\Action\Action { protected $cachePurger; protected $config; public function __construct(\Magento\Framework\App\Action\Context $context, \Magento\CacheInvalidate\Model\PurgeCache $cachePurger, \Mgt\Varnish\Model\Cache\Config $config) { goto F7542; F9ddd: parent::__construct($context); goto fe5d6; c7d4e: $this->config = $config; goto F9ddd; F7542: $this->cachePurger = $cachePurger; goto c7d4e; fe5d6: } public function execute() { goto c2015; B25d2: a5f78: goto b9aa7; c2015: $request = $this->getRequest(); goto B159b; a41d7: $response->setHeader("\103\157\x6e\164\145\x6e\x74\x2d\124\171\160\x65", "\x61\x70\160\154\151\x63\141\x74\x69\x6f\x6e\57\152\163\157\x6e"); goto Ca44b; Bf4e7: if (!($secretKey && $tag)) { goto a5f78; } goto f2627; f2627: try { goto Aa7ba; F19f2: $tags = [$tag]; goto f8c6b; Aa7ba: $apiSecretKey = $this->config->getApiSecretKey(); goto f3638; ea4c6: throw new \Exception("\123\x65\x63\x72\145\x74\x20\x61\x70\x69\x20\153\x65\171\x20\x69\x73\x20\156\157\x74\40\143\x6f\162\162\145\143\x74"); goto A49ea; ba98d: $body = ["\x73\x75\143\x63\x65\163\163" => 1, "\x6d\145\x73\x73\x61\x67\145" => sprintf("\126\x61\x72\x6e\151\x73\150\40\x43\141\x63\150\145\40\160\165\162\147\145\x64\x20\x62\171\40\146\157\x6c\154\x6f\167\x69\156\147\x20\x74\141\147\72\x20\45\x73", $tag)]; goto e914a; f3638: if (!($secretKey != $apiSecretKey)) { goto f5118; } goto ea4c6; f8c6b: $this->cachePurger->sendPurgeRequest($tags); goto ba98d; A49ea: f5118: goto F19f2; e914a: } catch (\Exception $e) { $errorMessage = $e->getMessage(); $body = ["\x73\x75\x63\143\145\163\x73" => 0, "\155\145\163\x73\141\147\145" => $errorMessage]; } goto B25d2; b9aa7: $body = json_encode($body); goto a41d7; Cc980: $secretKey = $request->getParam("\163\x65\x63\162\145\x74\x4b\x65\171"); goto D56c7; a213a: exit; goto c9d7a; Ca44b: $response->setBody($body); goto fd784; D56c7: $tag = $request->getParam("\164\x61\x67"); goto Bf4e7; c9a01: $body = []; goto Cc980; B159b: $response = $this->getResponse(); goto c9a01; fd784: $response->sendResponse(); goto a213a; c9d7a: } }
